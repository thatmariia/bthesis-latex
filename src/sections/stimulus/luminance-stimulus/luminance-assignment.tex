\subsubsection{Luminance assignment}
\label{sec:luminance-assignment}

First, all values of the stimulus $\fullmatrix$ are initialized with the void luminance $\vlum$. Then, the annuli with relevant contrasts are added to the matrix. Let $\view: \annuliset \to \{ \fig, \ground \}$ be the function mapping an annulus to its view. Let $\annstimmatrix \in \annuliset$, then
\begin{equation}
    \view(\annstimmatrix) = 
    \begin{cases}
        \fig & \text{ if } 
        \{ \annstart_\annstimmatrix, \cdots,  \annfinish_\annstimmatrix \}
        \cap
        \{ \figstart, \cdots, \figfinish \}
        \neq \emptyset \\
        \ground & \text{ otherwise} 
    \end{cases}.
\end{equation}
So, an annulus is said to be located in the figure if it is (partially) contained in it.

Let $\unirand: \annuliset \to U(0, 1)$ be a random value that varies per annulus. The values are independent and identically distributed (i.i.d.). Then for all $\annstimmatrix \in \annuliset$ and $\lambda, \mu \in \{ 0, 1, \cdots, \diam - 1\}, \ (i, j) = \annstart_\annstimmatrix + (\lambda, \mu)$,
\begin{equation}
    \fullmatrix_{i, j} \leftarrow \vlum +
    \begin{cases}
        (\annmatrix_{\lambda, \mu} - \vlum) \cdot \left( \unirand(\annstimmatrix) \contrange + \vlum \cdot (1 - \contrange) \right) 
        &\text{ if } \view(\annstimmatrix) = \fig  \\
        (\annmatrix_{\lambda, \mu} - \vlum) \cdot \unirand(\annstimmatrix) 
        &\text{ otherwise}
    \end{cases}.
\end{equation}
Now, the stimulus luminance matrix is complete.
Thus, the luminance of the void, similar to annuli's edges as demonstrated in Equation (\ref{eq:grating}), are still assigned the luminance of $\vlum$; the mean of all pixels' luminance values is also equal to $\vlum$. An example of the resulting luminance matrix' binary heat map is visualized in Figure \ref{fig:full-stimulus-example}.

\begin{figure}[!htp]
    \centering
    \input{assets/tikz-images/full-stimulus-annot}
    \caption{An example of the full stimulus with parameters $ \spatfreq = 5.7 \text{ cycles}/\circ, \vlum = 0.5, \diamdg = 0.7^\circ, \diam = 48, \anndistscale = 1, \fullwidthdg = 33.87^\circ, \fullheightdg = 27.09^\circ, \contrange = 0.01, \figwidthdg = 5^\circ, \figheightdg = 9^\circ, \figeccdg = 11^\circ, \patchsizedg = 4.9^\circ$.}
    \label{fig:full-stimulus-example}
\end{figure}
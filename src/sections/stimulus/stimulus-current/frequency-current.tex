\subsubsection{From frequency to current}

Finally, knowing the frequencies, the corresponding current inputs to each PING network can be derived. The conversion from frequency to current is separated into the following steps: collecting the spiking data from simulating with relevant currents, computing the frequencies associated with each simulation, and discovering the relationship between frequency and current.

\paragraph{Collecting spiking data}

To collect the required data for a given input current, we simulate the Izhikevich model over 1000 epochs. The model consists of a single PING network that includes as many excitatory and inhibitory neurons as does a general PING network in this thesis, as introduced in Section \ref{sec:grid-network}. Additionally, instead of the current input from an external stimulus, $I_\stim$ in Equation (\ref{eq:current-components}), an artificially crafted current $I_\inpt$ is used:
\begin{equation}
    I_{\inpt, v} = \begin{cases}
        \meancurrent_\ex & \text{ if } \type(v) = \ex \\
        \meancurrent_\inh & \text{ if } \type(v) = \inh
    \end{cases}.
\end{equation}
The input current to inhibitory neurons $\meancurrent_\inh$ is fixed for all simulations, while the input to excitatory neurons $\meancurrent_\ex$ is modulated per simulation. The simulations are performed for the values $\meancurrent_\ex = \{ 20, 21, \cdots, 50 \}$.

Equation (\ref{eq:Izhikevich-model-p30}) allows for detection of spikes. Thus, for each simulation, a list of numbers of excitatory neurons fired at each time step during that simulation can be extracted. A time-dependent signal is created for a simulation by discarding the first 300 time steps from that list.

\paragraph{Computing frequencies}

This thesis is concerned with gamma oscillations ($20 - 80$ Hz). It is assumed that for a signal with a given input current, the corresponding frequency is the most prominent within the gamma band that said signal triggers. To analyze the frequency behavior of a signal, it is first converted from the time domain to the frequency domain using the discrete Fourier transform (DFT). 

Although it provides information about the frequencies present in the signal, the DFT loses all information regarding the times at which particular frequencies occur. However, that information is essential as the spectral content of neural action potentials changes over time. The use of wavelets allows for analyzing such non-stationary signals. While the DFT considers the contributions from every sine and cosine wave, a discrete wavelet transform (DWT) acts as a band-pass filter that admits only a subset of frequencies at a given time.

Using a DWT, we can narrow the analysis to a particular frequency in the gamma band $\{ 20, 21, \cdots, 80 \}$. We apply a Morlet wavelet to the signal in the frequency domain for each frequency of interest. This wavelet represents a frequency carrier wave multiplied by a Gaussian window. Then, the number of spikes at the frequency of interest at each time step is obtained by performing the inverse DFT of the circular convolution of the signal in the frequency domain and the DFT of the wavelet. Finally, we take the mean of the number of spikes at each frequency of interest and find the frequency at which the resulting number is the largest. That frequency corresponds to the signal and, thus, the current input strength.

\paragraph{Discovering frequency-current relationship}

For each current input strength to excitatory neurons, the most prominent frequency is now known. Thus, the relationship can be analyzed and extrapolated. By plotting frequencies against currents, it can be clearly seen that they follow a linear relationship. Thus, the Theilâ€“Sen estimator can be used to fit a predictive model for the observed data. This regression method has been chosen due to its robustness against outliers. Knowing the slope and the intercept of the linear relationship between the frequency and current, the function $\cmap: \mathbb{R} \to \mathbb{R}$ mapping frequencies to currents can be defined:
\begin{equation}
    \cmap = \fcslope \cdot f + \fcintercept.
\end{equation}
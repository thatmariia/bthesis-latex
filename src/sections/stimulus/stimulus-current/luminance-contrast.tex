\subsubsection{From luminance to contrast}

\begin{figure}[t]
    \centering
    \begin{subfigure}[t]{0.4\textwidth}
        \centering
        \input{src/assets/tikz-images/stimulus-patch-lattice}
        \caption{A 20 $\times$ 20 lattice applied to a patch.}
        \label{fig:llc-lattice-example}
    \end{subfigure}
    \hspace{0.06\textwidth}
    \begin{subfigure}[t]{0.4\textwidth}
        \centering
        \includegraphics[width=\textwidth]{src/assets/images/local-contrast.png}
        \caption{Local contrasts of the patch in Figure \ref{fig:llc-lattice-example}: $0$ (black) $\to$ $1$ (white).}
        \label{fig:llc-local-contrast-example}
    \end{subfigure}
    \caption[Patch lattice and local contrast]{The lattice of a patch and its vertices' local contrasts. 
    The patch was generated with the parameters $\anndistscale = 1.5$, $\contrange = 1$.}
    \label{fig:lattice-local-contrast-example}
\end{figure}

To transform the stimulus patch $\patchmatrix$ to the patch of PING networks in V1, we apply the lattice of size $n \times n$, such that each oscillatory network contains a field of $m \times m$ pixels. An example of the resulting lattice is displayed in Figure \ref{fig:llc-lattice-example}.

Let $\pingnets$ be the set containing the PING networks. Let $\pix: \pingnets \to (\mathbb{Z}_+)^{2 \times m^2}$ be a function mapping a network to the set of all $m^2$ pixel coordinates it contains.
For each network $\pingnet \in \pingnets$, a local contrast $\LC_\pingnet: V \to [0, 1]$ is the weighted root-mean-squared (RMS) contrast defined as follows \cite{Frazor2006}:
\begin{equation}
    \LC_\pingnet = \sqrt{
        \frac{
            \sum_{(i, j) \in \patchmatrix} \weight_{\pingnet, (i, j)} \frac{(\patchmatrix_{i, j} - \overline{\fullmatrix})^2}{\overline{\fullmatrix}^2}
        }{
            \sum_{(i, j) \in \patchmatrix} \weight_{\pingnet, (i, j)}
        }
    },
\end{equation}
\begin{comment}
\begin{equation}
    \LC_\pingnet = \sqrt{
        \frac{
            \sum_{(i, j) \in \pix(\pingnet)} \weight_{\pingnet, (i, j)} \frac{(\patchmatrix_{i, j} - \overline{\fullmatrix})^2}{\overline{\fullmatrix}^2}
        }{
            \sum_{(i, j) \in \pix(\pingnet)} \weight_{\pingnet, (i, j)}
        }
    },
\end{equation}
\end{comment}
where $\overline{\fullmatrix}$ is the mean over all luminance values in $\fullmatrix$, and $\weight: \pingnets, \mathbb{N}^2 \to \mathbb{R}$ is the weight of a pixel with respect to a PING network. An example of a local contrast matrix can be seen in Figure \ref{fig:llc-local-contrast-example}.

The value of weight is specific to each network as it reflects its unique receptive field \cite{MaryamPLACEHOLDER}. Let $\centr : \pingnets \to \mathbb{R}_+^2$ be the function mapping a particular PING network in the patch to the location of its center. For the pixel $i, j \in \{ 0, 1, \cdots, \patchsize - 1 \}$, the weight with respect to a PING network $\pingnet$ is then defined as
\begin{equation}
    \weight_{\pingnet, (i, j)} = \exp \left(
        -\frac{\left( \frac{1}{\atopix} \cdot \| (i, j) - \centr(\pingnet) \|\right)^2}{ 2 \stdrf_\pingnet^2 }
    \right),
    \label{eq:weight-pixel-network}
\end{equation}
where $\stdrf_\pingnet: \pingnets \to \mathbb{R}$ is 
the standard deviation of the network's receptive field diameter. It has been found to be defined as follows \cite{Freeman2011, MaryamPLACEHOLDER}:  
\begin{equation}
    \stdrf_\pingnet = \frac{1}{4} \max{( \slopeRF \cdot \ecc_\pingnet + \interceptRF, \ \diamRF_{\min} )},
\end{equation}
where $\slopeRF \in \mathbb{R}$ is the slope of the receptive field, or the ratio of receptive field diameter to eccentricity, $\interceptRF \in \mathbb{R}$ is the intercept, and $\diamRF_{\min} \in \mathbb{R}_+$ is the diameter of the smallest receptive field. The values for these parameters are presented in Table \ref{tab:params-rf}.

\begin{table}[!htp]
    \centering
    \input{src/assets/tables/params-rf}
    \caption{The values of the parameters used to determine the standard deviation of the receptive field diameter \cite{MaryamPLACEHOLDER}.}
    \label{tab:params-rf}
\end{table}

As the center of the gaze (fovea) coincides with the center of the stimulus, the eccentricity $\ecc: \pingnets \to \mathbb{R}_+$ in degrees for a network $v \in \pingnets$ is
\begin{equation}
\begin{gathered}
    \ecc_{\pingnet} = \frac{1}{\atopix} \cdot \left\| \stimcenter - (\patchstart + \centr(\pingnet)) \right\|, \\
    \stimcenter = \left( \frac{\fullwidth}{2}, \frac{\fullheight}{2} \right).
\end{gathered}
\end{equation}
% ------------------------ TEXT

\newcommand{\stimfig}{{\it figure}}

% ------------------------ MATH

% conversion to current

\newcommand{\pingnets}{N_\ping}
\newcommand{\pingnet}{\chi}
\newcommand{\ecc}{\mathsf{ecc}}
\newcommand{\centr}{\mathsf{center}}
\newcommand{\LC}{\mathsf{LC}}
\newcommand{\weight}{\mathsf{weight}}
\newcommand{\slopeRF}{a_\mathsf{RF}}
\newcommand{\interceptRF}{b_\mathsf{RF}}
\newcommand{\diamRF}{{d_\mathsf{RF}}}
\newcommand{\fwhm}{\mathsf{fwhm}}
\newcommand{\pix}{\mathsf{pixels}}
\newcommand{\annulus}{\mathsf{annulus}}
\newcommand{\stdrf}{\sigma}

\newcommand{\meancurrent}{\mu}
\newcommand{\fcslope}{a_\mathsf{fc}}
\newcommand{\fcintercept}{b_\mathsf{fc}}

\newcommand{\eccangle}{\Phi}
\newcommand{\cortk}{k}
\newcommand{\corta}{a}
\newcommand{\cortb}{b}
\newcommand{\cortalpha}{\alpha}

% neural dynamics

\newcommand{\type}{\mathsf{type}}
\newcommand{\loc}{\mathsf{loc}}
\newcommand{\cmap}{\mathsf{cmap}}
\newcommand{\cost}{\mathsf{cost}}
\newcommand{\stim}{\mathrm{stim}}
\newcommand{\inpt}{\mathrm{input}}
\newcommand{\ping}{\mathrm{ping}}
\newcommand{\syn}{\mathrm{syn}}
\newcommand{\noise}{\mathrm{noise}}
\newcommand{\inh}{\mathrm{in}}
\newcommand{\ex}{\mathrm{ex}}
\newcommand{\peak}{\mathrm{peak}}
\newcommand{\izhi}{\mathrm{Izhikevich}}

% stimulus parameters

\newcommand{\spatfreq}{\Omega}
\newcommand{\vlum}{\mathsf{bg}}
\newcommand{\diam}{d}
\newcommand{\diamdg}{\measuredangle d}
\newcommand{\contrange}{\eta}
\newcommand{\figwidthdg}{\measuredangle w_F}
\newcommand{\figwidth}{{w_F}}
\newcommand{\figheightdg}{\measuredangle h_F}
\newcommand{\figheight}{{h_F}}
\newcommand{\figeccdg}{\measuredangle \ecc_F}
\newcommand{\figecc}{\ecc_F}
\newcommand{\anndistscale}{k}
\newcommand{\fullwidthdg}{\measuredangle w_L}
\newcommand{\fullwidth}{w_L}
\newcommand{\fullheightdg}{\measuredangle h_L}
\newcommand{\fullheight}{h_L}
\newcommand{\patchsizedg}{\measuredangle \ell}
\newcommand{\patchsize}{\ell}

\newcommand{\atopix}{\mathsf{atopix}}
\newcommand{\figdiag}{\mathsf{diag}_F}
\newcommand{\stimcenter}{\fullmatrix_O}

% - annulus composition
\newcommand{\annmatrix}{\Gamma}
\newcommand{\annradii}{R}

% - figure composition
\newcommand{\fullmatrix}{L}
\newcommand{\figmatrix}{F}
\newcommand{\figangle}{\theta}
\newcommand{\figanglemin}{\theta_{\min}}
\newcommand{\figanglemax}{\theta_{\max}}
\newcommand{\figcenter}{\figmatrix_O}
\newcommand{\figstart}{\scalebox{1}{\rotatebox[origin=c]{-90}{\Lsteel}}_F}
\newcommand{\figfinish}{\scalebox{1}{\rotatebox[origin=c]{90}{\Lsteel}}_F}

% - positioning annuli
\newcommand{\anndist}{\delta}
\newcommand{\repsinrow}{w_{\#}}
\newcommand{\repsincol}{h_{\#}}
\newcommand{\annuliset}{\mathcal{A}}
\newcommand{\annstart}{\scalebox{1}{\rotatebox[origin=c]{-90}{\Lsteel}}}

% - luminance assignment
\newcommand{\view}{\mathsf{view}}
\newcommand{\fig}{\mathrm{figure}}
\newcommand{\ground}{\mathrm{ground}}
\newcommand{\annstimmatrix}{A}
\newcommand{\unirand}{\mathsf{unirand}}

% - patch selection
\newcommand{\patchmatrix}{P}
\newcommand{\patchstart}{\scalebox{1}{\rotatebox[origin=c]{-90}{\Lsteel}}_{\patchmatrix}}

% general stuff

\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}

% ------------------------ TIKZ

\DeclareRobustCommand{\tikzcirc}[1]{%
    \begin{tikzpicture}[baseline=-0.7ex]
        \filldraw[color=black, fill=#1, thick] (0, 0) circle (0.45ex);
    \end{tikzpicture}%
}

% ------------------------ COLORS

\definecolor{main-color}{HTML}{FCEA88}
\definecolor{sec-color}{HTML}{FFA3AF}
\definecolor{third-color}{HTML}{ACDDE7}

\definecolor{gray-color}{HTML}{D0D0D0}

\DeclareRobustCommand{\dochl}[1]{{\sethlcolor{sec-color}\hl{#1}}}

% ------------------------ FONTS

\setmainfont{AvenirNextCyr}[
    Path=fonts/avenir/,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Demi,
    ItalicFont=*-Italic,
    BoldItalicFont=*-DemiItalic
]

\urlstyle{same}

\newfontfamily{\emphfont}{Canela}[
    Path=fonts/canela/,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-RegularItalic,
    BoldItalicFont=*-BoldItalic
]

\setmathfont{Libertinus Math}
%\DeclareMathSizes{12}{5}{5}{5}
% {t-size} {mt-size} {s-size} {ss-size}
% <mt-size> as the math text size, <s-size> as the script size and <ss-size> the scriptscript size to be used in math, when <t-size> is the current text size

% ------------------------ TITLE STYLE

\setcounter{secnumdepth}{3}

\titleformat{\section}
  {\emphfont\LARGE\bfseries}{\thesection.}{0.5em}{}
\titleformat{\subsection}
  {\emphfont\Large\bfseries}{\thesubsection.}{0.5em}{}
\titleformat{\subsubsection}
  {\emphfont\large\bfseries}{\thesubsubsection.}{0.5em}{}
  
\titlespacing*{\section}{0pt}{\baselineskip}{0.3em}
\titlespacing*{\subsection}{0pt}{0.5em}{0.3em}
\titlespacing*{\subsubsection}{0pt}{0.3em}{0em}


\renewcommand{\cfttoctitlefont}{\LARGE\bfseries\emphfont}
\renewcommand{\cftloftitlefont}{\LARGE\bfseries\emphfont}
\renewcommand{\cftlottitlefont}{\LARGE\bfseries\emphfont}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\newcommand\mydot[1]{\scalebox{#1}{.}}
\renewcommand\cftdot{{\color{main-color}\mydot{2}}}

%\renewcommand{\cftsecindent}{0em}
%\renewcommand{\cftsubsecindent}{0em}
%\renewcommand{\cftsubsubsecindent}{0em}
%\renewcommand{\cftsecafterpnum}{\hspace*{0em}}
%\renewcommand{\cftsubsecafterpnum}{\hspace*{0em}}
%\renewcommand{\cftsubsubsecafterpnum}{\hspace*{0em}}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
\newcommand{\toc}{\vskip -2em \tableofcontents}

\addto\captionsenglish{\renewcommand{\listfigurename}{Figures}}
\newcommand{\lof}{\listoffigures}

\addto\captionsenglish{\renewcommand{\listtablename}{Tables}}
\newcommand{\lot}{\listoftables}
  
% ------------------------ TABLES

\setlength\arrayrulewidth{1pt}
\arrayrulecolor{main-color}

% ------------------------ FIELDS

\newenvironment{paraphrase}{{\bf \Large TO PARAPHRASE::}}{}
\surroundwithmdframed[
    hidealllines=true,
    backgroundcolor=third-color,
    roundcorner=10pt,
    innerleftmargin=10pt,
    innerrightmargin=10pt,
    innertopmargin=15pt,
    innerbottommargin=15pt,
    skipabove=1em,
    skipbelow=0em
]{paraphrase}

\newenvironment{notes}{{\bf \Large NOTES::}}{}
\surroundwithmdframed[
    hidealllines=true,
    backgroundcolor=third-color,
    roundcorner=10pt,
    innerleftmargin=10pt,
    innerrightmargin=10pt,
    innertopmargin=15pt,
    innerbottommargin=15pt,
    skipabove=1em,
    skipbelow=0em
]{notes}

\newcommand{\todo}[1]{
    \begin{tikzpicture}
    \begin{scope}
        \node[draw=sec-color, fill=sec-color, rounded corners=0.3cm] (1) {%
        \begin{varwidth}{\textwidth}
            {\bf \large TODO::} {\normalsize #1}
        \end{varwidth}
        };
    \end{scope}
\end{tikzpicture}
}

\newcommand{\bgcolorsmalltext}[3]{
    \begin{tikzpicture}
    \begin{scope}
        \node[draw=#1, fill=#1, rounded corners=0.3cm] (1) {%
        \begin{varwidth}{\textwidth}
            {\footnotesize \textcolor{#2}{#3}}
        \end{varwidth}
        };
    \end{scope}
\end{tikzpicture}
}

\newcommand{\bgcolortext}[3]{
    \begin{tikzpicture}
    \begin{scope}
        \node[draw=#1, fill=#1, rounded corners=0.3cm] (1) {%
        \begin{varwidth}{\textwidth}
            {\textcolor{#2}{#3}}
        \end{varwidth}
        };
    \end{scope}
\end{tikzpicture}
}

% ------------------------ FLOATS

\renewcommand{\floatpagefraction}{.8}%

% ------------------------ FIGURES

\captionsetup[subfigure]{justification=centering}

% save the meaning of \includegraphics
\LetLtxMacro\latexincludegraphics\includegraphics
\renewcommand{\includegraphics}[2][]{%
    \begin{tikzpicture}
        
        \begin{scope}
            \node[anchor=south west,inner sep=0] at (0,0) {\latexincludegraphics[#1]{#2}};
        \end{scope}
        
        \begin{scope}
            \clip
                (current bounding box.north west) -- 
                (current bounding box.north east) --
                (current bounding box.south east) --
                (current bounding box.south west) -- cycle
            [rounded corners=0.2cm]
                (current bounding box.north west) -- 
                (current bounding box.south west) -- 
                (current bounding box.south east) --
                (current bounding box.north east) -- cycle;
            \fill[white]
                (current bounding box.north west) -- 
                (current bounding box.north east) --
                (current bounding box.south east) --
                (current bounding box.south west) -- cycle;
        \end{scope}

    \end{tikzpicture}
}

% ------------------------ OTHER

\pgfplotsset{compat=18} 

\setlength\parskip{.5em}
\setlength{\parindent}{0pt}

\sloppy

\makeatother

